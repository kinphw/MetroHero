#include "map_data.h"
#include <string.h>

// ========================
// 맵 데이터 정의 (상단에 모아두기)
// ========================

static const char* MAP_STAGE_1[] = {
    "########################################",
    "#@....##################...............#",
    "#.....#.........a......................#",
    "#.....#.####...........#########.......#",
    "#.....#.#..#...........#.......#.......#",
    "#.......#..#############.......#.......#",
    "#.......#..................#####.......#",
    "#########..................#...........#",
    "#.........................##......b....#",
    "#.......#####..........#####...........#",
    "#.......#...#..........#...............#",
    "#.......#...############...............#",
    "#.......#..............................#",
    "#.......#############..................#",
    "#.....................#................#",
    "#.....................#................#",
    "#.....................##################",
    "#......................................#",
    "#......................................#",
    "########################################"
};

static const char* MAP_STAGE_2[] = {
    "########################################",
    "#====================================..#",
    "#====================================..#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "#......................................#",
    "########################################"
};

static const char* MAP_STAGE_3[] = {
    "####################",
    "#..................#",
    "#....####..........#",
    "#....#..#..........#",
    "#....####..........#",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "####################"
};

static const char* MAP_DEFAULT[] = {
    "####################",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "#..................#",
    "####################"
};

// ========================
// 로직 함수들
// ========================

// ★ 공통 로드 함수
static void load_map_from_data(Map* m, const char** mapData, int height) {
    m->height = height;
    m->width = strlen(mapData[0]);

    for (int y = 0; y < m->height; y++) {
        for (int x = 0; x < m->width && x < MAX_MAP_W; x++) {
            m->tiles[y][x] = mapData[y][x];
        }
    }
}

// ★ 스테이지 번호로 맵 로드
void load_map(Map* m, int stageNumber) {
    switch (stageNumber) {
    case 1:
        load_map_from_data(m, MAP_STAGE_1, sizeof(MAP_STAGE_1) / sizeof(MAP_STAGE_1[0]));
        break;
    case 2:
        load_map_from_data(m, MAP_STAGE_2, sizeof(MAP_STAGE_2) / sizeof(MAP_STAGE_2[0]));
        break;
    case 3:
        load_map_from_data(m, MAP_STAGE_3, sizeof(MAP_STAGE_3) / sizeof(MAP_STAGE_3[0]));
        break;
    default:
        load_map_from_data(m, MAP_DEFAULT, sizeof(MAP_DEFAULT) / sizeof(MAP_DEFAULT[0]));
        break;
    }
}