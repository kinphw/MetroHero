#include "stage_01.h"
#include <stdlib.h>
#include "../../world/glyph.h"

// ============================================
// Stage 1 Map Data
// ============================================
static const char* MAP_LINES[] = {
"########################################################################################################################",
"########################################################################################################################",
"############..........@.........##############..........###########....................###############################",
"############..................0.##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############..........A.........##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"############....................##############..........###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########............A.......###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.............###########.......................###########....................###############################",
"########.....a.......###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########......b.............###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................###########....................###############....###########",
"########.............###########.......................##.....####....................###############....###########",
"########...............................................##.###.####....................###############....###########",
"########..................................................###.####....................###############....###########",
"########...............................................######.####....................###############....###########",
"########...............................................######.####....................###############....###########",
"########...............................................######....#....................###############....###########",
"########...............................................#########.#....................###############....###########",
"########...............................................#########......................###############....###########",
"########...............................................###########....................###############....###########",
"########...............................................###########....................###############....###########",
"########...............................................###########....................###############....###########",
"########...............................................###########....................###############....###########",
"###############.................#######################################################################....########",
"###############.................#######################################################################....########",
"###############.................#######################################################################....########",
"###############.................#######################################################################....########",
"###############.................########################C##############################################....########",
"###############.................########################.##############################################....########",
"###############.................########################.##############################################....########",
"###############.................########################.##############################################....########",
"###############.................########################.##############################################....########",
"###############..........................................##############################################....########",
"###############....c............########################.##############################################....########",
"###############.................########################.##############################################....########",
"###############.................########################.##############################################....########",
"###############.................########################.##############################################....########",
"########################################################################################################################",
"########################################################################################################################"
};

// ============================================
// Stage 1 Chests
// ============================================
static const ChestConfig CHESTS[] = {
    {'0', "weapon", "초보자 검"},
    {'1', "armor",  "가죽 갑옷"},
    {'2', "item",   "HP 포션"},
    {'3', "item",   "민첩의 물약"},
    {'4', "item",   "힘의 물약"},
};

// ============================================
// Stage 1 Enemies
// ============================================

// Type 'a': 맹혹한고양이
static const char* DIALOGUES_A[] = {
    "나는 잔인한 냥코다옹",
    "냥코냥코 대전쟁"
};

// Type 'b': 경비로봇
static const char* DIALOGUES_B[] = {
    "전철역 내 침입자를 인식했습니다...",
    "경고: 비인가 인원입니다.",
    "돌아가라 날 건들면 후회할것이다"
};

static const EnemyConfig ENEMIES[] = {
    {
        'a', "맹혹한고양이",
        5,              // maxHp
        1, 3,           // attackMin, Max
        0,              // defense
        DIALOGUES_A,
        sizeof(DIALOGUES_A) / sizeof(DIALOGUES_A[0]),
        COLOR_BRIGHT_CYAN
    },
    {
        'b', "경비로봇",
        10,
        100, 100,
        0,
        DIALOGUES_B,
        sizeof(DIALOGUES_B) / sizeof(DIALOGUES_B[0]),
        COLOR_RED
    }
};

// ============================================
// Stage 1 NPCs
// ============================================

// A: Merchant
static const char* NPC_DIALOGUES_A[] = {
    "당신은 이제 이곳에서 모험을 시작하게 됩니다.. ",
    "이곳은 성균관대역입니다.",
    "당신은 이 모험을 끝내고 집으로 돌아가기 위해서는 영등포역에 도착해야합니다...",
    "일단 이 역의 역장을 물리치고 의왕역으로 넘어가야 할 것입니다...",
    "행운을 빕니다... 후후후..."
};

// C: Citizen
static const char* NPC_DIALOGUES_C[] = {
    "안녕하세요, 좋은 하루입니다.",
    "요즘 전철역이 위험하다고 하더라고요.",
    "지하에는 이상한 것들이 많다던데...",
    "조심히 다니세요!"
};

static const NPCConfig NPCS[] = {
    {
        'A', "우건박", GLYPH_NPC_MERCHANT,
        NPC_DIALOGUES_A, sizeof(NPC_DIALOGUES_A)/sizeof(NPC_DIALOGUES_A[0]),
        0, "general", 1 // canTrade=0 currently but shopType set? Original code had canTrade=0.
    },
    {
        'C', "시민", GLYPH_NPC_CITIZEN,
        NPC_DIALOGUES_C, sizeof(NPC_DIALOGUES_C)/sizeof(NPC_DIALOGUES_C[0]),
        0, NULL, 0
    }
};

// ============================================
// Stage 1 Story (Cinematics)
// ============================================

// --- Intro ---
static const CinematicLine INTRO_LINES[] = {
    { "", STYLE_NORMAL, 300 },
    { "[ STAGE 1 ]", STYLE_TITLE, 500 },
    { "", STYLE_NORMAL, 200 },
    { "성균관대역", STYLE_SUBTITLE, 800 },
};

static const Cinematic INTRO_CINEMATIC = {
    NULL,
    INTRO_LINES,
    sizeof(INTRO_LINES) / sizeof(INTRO_LINES[0]),
    25,
    1,
    COLOR_YELLOW,
    COLOR_WHITE
};

// --- Outro (Clear) ---
static const CinematicLine CLEAR_LINES[] = {
    { "", STYLE_NORMAL, 300 },
    { "★ STAGE CLEAR ★", STYLE_TITLE, 800 },
    { "", STYLE_NORMAL, 500 },
    { "성균관대역을 정화했다!", STYLE_TYPEWRITER, 600 },
    { "", STYLE_NORMAL, 300 },
    { "하지만 어둠은 더 깊은 곳에서 기다리고 있다...", STYLE_TYPEWRITER, 0 },
};

static const Cinematic CLEAR_CINEMATIC = {
    NULL,
    CLEAR_LINES,
    sizeof(CLEAR_LINES) / sizeof(CLEAR_LINES[0]),
    30, 
    1, 
    COLOR_BRIGHT_GREEN, 
    COLOR_WHITE
};

// ============================================
// Stage Package
// ============================================
const StageData STAGE_01_DATA = {
    1, // ID
    MAP_LINES,
    sizeof(MAP_LINES) / sizeof(MAP_LINES[0]),
    CHESTS,
    sizeof(CHESTS) / sizeof(CHESTS[0]),
    ENEMIES,
    sizeof(ENEMIES) / sizeof(ENEMIES[0]),
    NPCS,
    sizeof(NPCS) / sizeof(NPCS[0]),
    &INTRO_CINEMATIC,
    &CLEAR_CINEMATIC
};
